dependencies:
  pre:
    - git clone https://github.com/mietek/halcyon.git $HOME/halcyon
    - mv rivet-core rivet
    - mv rivet-simple-deploy rivet
    - mv rivet-docker rivet
    - mv rivet-migration rivet
  override:
    - source <( $HOME/halcyon/halcyon paths ) && cd rivet && HALCYON_PREFIX=/tmp halcyon install .:
        timeout: 600
    
test:
  override:
    - echo 0

deployment:
  master:
    branch: master
    commands:
      - cd /tmp/bin && tar cvzf /tmp/rivet-ubuntu.gz rivet
      - source $HOME/halcyon/lib/bashmenot/src.sh && s3_upload /tmp/rivet-ubuntu.gz s3.dbp.io rivet-ubuntu.gz public